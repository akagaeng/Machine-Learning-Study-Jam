# 분류 (Classification)

## 분류 임계값 (Classification Threshold)
로지스틱 회귀 모델에서 이메일에 관해 0.9995가 반환되면?
- 스팸일 가능성이 매우 높은 메일

로지스틱 회귀 모형에서 예측 점수가 0.0003점이면?
- 이 이메일은 스팸이 아닐 가능성이 높음

예측 점수가 0.6점인 이메일은?
- 애매함

로지스틱 회귀 값을 이진 카테고리에 매핑하려면 분류 임계값(결정 임계값이라고도 함)을 정의해야 한다. 

- 임계값보다 높은 값: '스팸'
- 임계값보다 낮은 값: '스팸 아님'

```
분류 임계값은 항상 0.5여야 한다고 생각하기 쉽지만, 임계값은 문제에 따라 달라지므로 값을 조정해야 한다.
```

## 분류 참(true) vs 허위(false), 양성(positive) vs 음성(negative)

```
이솝우화: 양치기 소년에서
양치기 소년이 늑대다! 라고 소리쳤으니 사람들은 소년이 거짓말을 한다고 생각해서 집에서 나오지 않았다.
```

### Positive vs Negative
- 늑대다!: 양성 클래스(positive)
- 늑대가 없다: 네거티브 클래스(negative)

### True vs False
- true: 소년이 참을 이야기 했다.
- false: 소년이 거짓을 이야기 했다.

### 늑대 예측 모델에서 발생할 수 있는 4가지 결과
- 참 양성(TP, true positive)
  + 소년: 늑대다! `양성, positive`
  + 현실: 늑대가 있었다. `참, true`
- 허위 양성(FP, false positive)
  + 소년: 늑대다! `양성, positive`
  + 현실: 늑대가 없었다. `거짓, false`
- 참 음성(TN, true negative)
  + 소년: 늑대가 없다! `음성, negative`
  + 현실: 늑대가 없다. `참, true`
- 허위 음성(FN, false negative)
  + 소년: 늑대가 없다! `음성, negative`
  + 현실: 늑대가 있었다. `거짓, false`

### 정확한 예측 vs 잘못된 예측
- 정확한 예측
  + 참 양성 `true positive`
  + 거짓 음성 `false negative`
- 잘못된 예측
  + 거짓 양성 `false positive`
  + 참 음성 `true negative`

## 정확성

정확성은 분류 모델 평가를 위한 측정항목 중 하나로써 모델의 예측이 얼마나 정확한가를 보여준다. 정확성을 구하는 식은 다음과 같다.

```
정확성 = 정확한 예측수 / 총 예측수
```

```
정확성 = (TP + TN) / (TP + TN + FP + FN)
```

### 양성종양(Positive), 악성종양(Negative)인 경우
- TP
  + 실제: 악성종양(Positive)
  + ML모델 예측: 악성종양(Positive)
  + TP 결과: 1개
- FN
  + 실제: 악성종양(Positive)
  + ML모델 예측: 양성종양(Negative)
  + 8개
- FP
  + 실제: 양성종양(Negative)
  + ML모델 예측: 악성종양(Positive)
  + 1개
- TN
  + 실제: 양성종양(Negative)
  + ML모델 예측: 양성종양(Negative)
  + 90개

악성 종양(Positive)을 제대로 예측한 경우
```
1/9 = TP / (TP + FN)

```

양성 종양(Negative)을 제대로 예측
```
90/91 = TN / (TN + FP)
```

> 클래스 불균형 데이터 세트(두 클래스 라벨 즉, Positive와 Negative가 99:1과 같이 서로 크게 다른 빈도를 보임)를 사용하면 양성 라벨수와 음성 라벨수가 상당히 다르므로 정확성만으로는 모든 것을 평가할 수 없다!

