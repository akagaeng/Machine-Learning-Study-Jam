# 다중 클래스 신경망

### 이진 분류 모델
- 스팸, 스팸 아님 등의 2개 중에 하나를 분류하는 모델
- 로지스틱 회귀로 해결 가능

### 다중 클래스 문제
- 이 개는 비글인가요, 바셋하운드인가요, 아니면 블러드하운드인가요?
- 이 꽃은 시베리안 아이리스인가요, 더치 아이리스인가요, 블루 플래그 아이리스인가요, 아니면 드워프 비어디드 아이리스인가요?
- 이 비행기는 보잉 747인가요, 에어버스 320인가요, 보잉 777인가요, 아니면 엠브라에르 190인가요?
- 이 이미지는 사과, 곰, 사탕, 개, 계란 중 무엇의 이미지인가요?
- 위와 같은 양자택일이 아닌 경우 로지스틱 회귀로 해결 불가

## 일대다 (1:N)
- 이진 분류를 활용하여 N개의 분류를 해결하는 방법
- N개의 각 출력 노드마다 이진 분류를 사용하여 분류하는 방법
  + 노드 1: 사과인가요? T/F
  + 노드 2: 곰인가요? T/F
  + 노드 3: 사탕인가요? T/F
  + 노드 4: 개인가요? T/F
  + 노드 5: 계란인가요? T/F
 
## 소프트맥스
- 다중 클래스에서 각 노드들의 출력의 합을 1.0을 만든다.
  + 다중 클래스 중 각 노드는 로지스틱 회귀 출력으로써 0~1 사이의 값이 나온다.
    * 스팸일 확률 + 스팸이 아닐 확률 = 1.0
  + 로지스틱 회귀의 출력이 0~1 사이의 값이 나오도록 하는 것처럼 다중 클래스에서도 동일한 아이디어를 적용
- 로지스틱 회귀를 다중 클래스로 확장

### 소프트맥스 옵션

전체 소프트맥스
  - 모든 가능한 클래스의 확률을 계산하는 소프트맥스
  - 클래스 수가 적으면 매우 적은 비용이 들지만, 클래스 수가 증가하면 엄청나게 많은 비용이 든다.

후보 샘플링
  - 소프트맥스가 양성 레벨의 확률은 모두 계산함
  - 음성 라벨의 경우 무작위 샘플의 확률만 계산한다.
  - 클래스 수가 많은 문제에서 효율성이 향상된다.

### 라벨 1개 대 라벨 여러 개
- 소프트맥스에서는 각 예가 정확히 한 클래스의 멤버라고 가정한다.
- 하나의 예가 동시에 여러 클래스의 멤버의 경우에는
  + 소프트맥스를 사용할 수 없고,
  + 로지스틱 회귀를 여러 개 사용해야 한다.

```
예를 들어 과일바구니가 있다고 하자.
이 안에는 배, 오렌지, 사과 등 여러 과일이 있는데 
- 소프트맥스는 이 과일바구니가 사과일 확률, 오렌지일 확률 등을 구하는 것
- 이 과일바구니에 사과가 있는지, 오렌지가 있는지를 판단하기 위해서는 
  로지스틱 회귀를 여러 개 사용해야 한다.
  
과일바구니라는 한 예는 
배 클래스, 오렌지 클래스, 사과 클래스 등 
여러 클래스의 멤버가 될 수 있기 때문이다.
``` 
